<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Enhanced OpenLayers Basemap Switcher with WMS</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol/ol.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
      color: #333;
      line-height: 1.6;
    }
    
    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
    }
    
    header {
      text-align: center;
      margin-bottom: 20px;
      color: white;
      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
    }
    
    header h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
    }
    
    header p {
      font-size: 1.1rem;
      max-width: 800px;
      margin: 0 auto;
    }
    
    .app-container {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }
    
    @media (min-width: 992px) {
      .app-container {
        flex-direction: row;
      }
      
      .controls-panel {
        flex: 0 0 300px;
      }
    }
    
    .controls-panel {
      background: rgba(255, 255, 255, 0.9);
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      backdrop-filter: blur(10px);
    }
    
    .panel-section {
      margin-bottom: 25px;
      padding-bottom: 20px;
      border-bottom: 1px solid #e0e0e0;
    }
    
    .panel-section:last-child {
      border-bottom: none;
      margin-bottom: 0;
    }
    
    .panel-section h3 {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 15px;
      color: #2c3e50;
      font-size: 1.3rem;
    }
    
    .panel-section h3 i {
      color: #3498db;
    }
    
    .basemap-options {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    
    .basemap-option {
      position: relative;
      border: 2px solid #ddd;
      border-radius: 8px;
      overflow: hidden;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .basemap-option:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
    }
    
    .basemap-option.selected {
      border-color: #3498db;
      box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.3);
    }
    
    .basemap-preview {
      height: 80px;
      background-size: cover;
      background-position: center;
    }
    
    .basemap-name {
      padding: 8px;
      text-align: center;
      font-weight: 600;
      background: white;
    }
    
    .basemap-option input {
      position: absolute;
      opacity: 0;
      width: 0;
      height: 0;
    }
    
    .toggle-container {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 0;
    }
    
    .toggle-label {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 600;
    }
    
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 26px;
    }
    
    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: .4s;
      border-radius: 34px;
    }
    
    .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }
    
    input:checked + .slider {
      background-color: #3498db;
    }
    
    input:checked + .slider:before {
      transform: translateX(24px);
    }
    
    .map-info {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 15px;
      margin-top: 15px;
    }
    
    .map-info h4 {
      margin-bottom: 10px;
      color: #2c3e50;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .coordinates {
      font-family: monospace;
      background: #e9ecef;
      padding: 8px;
      border-radius: 4px;
      margin-top: 10px;
    }
    
    #map {
      width: 100%;
      height: 70vh;
      border-radius: 12px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      overflow: hidden;
    }
    
    footer {
      text-align: center;
      margin-top: 20px;
      color: white;
      font-size: 0.9rem;
    }
    
    .legend {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
    }
    
    .legend-item {
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .legend-color {
      width: 20px;
      height: 20px;
      border-radius: 4px;
    }
    
    .legend-label {
      font-size: 0.9rem;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1><i class="fas fa-map-marked-alt"></i> Interactive Map Viewer</h1>
      <p>Switch between basemaps and toggle WMS overlays with this enhanced OpenLayers application</p>
    </header>
    
    <div class="app-container">
      <div class="controls-panel">
        <div class="panel-section">
          <h3><i class="fas fa-layer-group"></i> Basemap Selection</h3>
          <div class="basemap-options">
            <label class="basemap-option selected" for="osm">
              <div class="basemap-preview" style="background-image: url('https://a.tile.openstreetmap.org/10/512/512.png')"></div>
              <div class="basemap-name">OpenStreetMap</div>
              <input type="radio" name="basemap" value="osm" id="osm" checked>
            </label>
            
            <label class="basemap-option" for="esri">
              <div class="basemap-preview" style="background-image: url('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/10/512/512')"></div>
              <div class="basemap-name">ESRI Imagery</div>
              <input type="radio" name="basemap" value="esri" id="esri">
            </label>
            
            <label class="basemap-option" for="topo">
              <div class="basemap-preview" style="background-image: url('https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/10/512/512')"></div>
              <div class="basemap-name">ESRI Topographic</div>
              <input type="radio" name="basemap" value="topo" id="topo">
            </label>
            
            <label class="basemap-option" for="carto">
              <div class="basemap-preview" style="background-image: url('https://a.basemaps.cartocdn.com/light_all/10/512/512.png')"></div>
              <div class="basemap-name">Carto Light</div>
              <input type="radio" name="basemap" value="carto" id="carto">
            </label>
          </div>
        </div>
        
        <div class="panel-section">
          <h3><i class="fas fa-map"></i> Overlay Options</h3>
          <div class="toggle-container">
            <div class="toggle-label">
              <i class="fas fa-layer-group"></i>
              <span>WMS States Overlay</span>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="wmsToggle">
              <span class="slider"></span>
            </label>
          </div>
          
          <div class="toggle-container">
            <div class="toggle-label">
              <i class="fas fa-borders-all"></i>
              <span>State Borders</span>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="bordersToggle">
              <span class="slider"></span>
            </label>
          </div>
        </div>
        
        <div class="panel-section">
          <h3><i class="fas fa-info-circle"></i> Map Information</h3>
          <div class="map-info">
            <h4><i class="fas fa-crosshairs"></i> Current Coordinates</h4>
            <div class="coordinates" id="coordinates">Lat: 39.8, Lon: -98.5</div>
            
            <h4><i class="fas fa-layer-group"></i> Active Layers</h4>
            <div class="legend">
              <div class="legend-item">
                <div class="legend-color" style="background-color: #3498db;"></div>
                <div class="legend-label">WMS States</div>
              </div>
              <div class="legend-item">
                <div class="legend-color" style="background-color: #e74c3c;"></div>
                <div class="legend-label">State Borders</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div id="map"></div>
    </div>
    
    <footer>
      <p>Enhanced OpenLayers Map Viewer | Built with OpenLayers, HTML5, and CSS3</p>
    </footer>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/ol/ol.js"></script>
  <script>
    // OSM basemap
    const osmLayer = new ol.layer.Tile({
      source: new ol.source.OSM(),
      visible: true,
      title: 'OpenStreetMap'
    });

    // ESRI imagery basemap
    const esriLayer = new ol.layer.Tile({
      source: new ol.source.XYZ({
        attributions: 'Tiles © Esri',
        url: 'https://services.arcgisonline.com/ArcGIS/rest/services/' +
             'World_Imagery/MapServer/tile/{z}/{y}/{x}'
      }),
      visible: false,
      title: 'ESRI Imagery'
    });

    // ESRI topographic basemap
    const topoLayer = new ol.layer.Tile({
      source: new ol.source.XYZ({
        attributions: 'Tiles © Esri',
        url: 'https://services.arcgisonline.com/ArcGIS/rest/services/' +
             'World_Topo_Map/MapServer/tile/{z}/{y}/{x}'
      }),
      visible: false,
      title: 'ESRI Topographic'
    });

    // Carto Light basemap
    const cartoLayer = new ol.layer.Tile({
      source: new ol.source.XYZ({
        attributions: 'Tiles © CARTO',
        url: 'https://a.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png'
      }),
      visible: false,
      title: 'Carto Light'
    });

    // WMS overlay
    const wmsLayer = new ol.layer.Image({
      source: new ol.source.ImageWMS({
        url: 'https://ahocevar.com/geoserver/wms',
        params: { 'LAYERS': 'topp:states', 'TILED': true },
        ratio: 1,
        serverType: 'geoserver'
      }),
      opacity: 0.7,
      visible: false,
      title: 'WMS States'
    });

    // State borders layer
    const bordersLayer = new ol.layer.Vector({
      source: new ol.source.Vector({
        url: 'https://openlayers.org/en/latest/examples/data/geojson/countries.geojson',
        format: new ol.format.GeoJSON()
      }),
      style: new ol.style.Style({
        stroke: new ol.style.Stroke({
          color: '#e74c3c',
          width: 2
        }),
        fill: new ol.style.Fill({
          color: 'rgba(231, 76, 60, 0.1)'
        })
      }),
      visible: false,
      title: 'State Borders'
    });

    // Map
    const map = new ol.Map({
      target: 'map',
      layers: [osmLayer, esriLayer, topoLayer, cartoLayer, wmsLayer, bordersLayer],
      view: new ol.View({
        center: ol.proj.fromLonLat([-98.5, 39.8]), // continental US
        zoom: 4
      })
    });

    // Update coordinates display on mouse move
    map.on('pointermove', function(evt) {
      const coordinate = ol.proj.toLonLat(evt.coordinate);
      document.getElementById('coordinates').innerHTML = 
        `Lat: ${coordinate[1].toFixed(4)}, Lon: ${coordinate[0].toFixed(4)}`;
    });

    // Basemap switcher
    document.querySelectorAll('input[name="basemap"]').forEach(radio => {
      radio.addEventListener('change', function() {
        // Update UI
        document.querySelectorAll('.basemap-option').forEach(option => {
          option.classList.remove('selected');
        });
        this.closest('.basemap-option').classList.add('selected');
        
        // Update map layers
        osmLayer.setVisible(this.value === 'osm');
        esriLayer.setVisible(this.value === 'esri');
        topoLayer.setVisible(this.value === 'topo');
        cartoLayer.setVisible(this.value === 'carto');
      });
    });

    // WMS toggle
    document.getElementById('wmsToggle').addEventListener('change', function() {
      wmsLayer.setVisible(this.checked);
    });

    // Borders toggle
    document.getElementById('bordersToggle').addEventListener('change', function() {
      bordersLayer.setVisible(this.checked);
    });

    // Initialize the UI
    document.addEventListener('DOMContentLoaded', function() {
      // Set initial active basemap
      document.querySelector('input[name="basemap"]:checked')
        .closest('.basemap-option').classList.add('selected');
    });
  </script>
</body>
</html>
